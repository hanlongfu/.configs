"use strict";var p=Object.defineProperty;var E=Object.getOwnPropertyDescriptor;var M=Object.getOwnPropertyNames;var C=Object.prototype.hasOwnProperty;var N=(e,t)=>{for(var s in t)p(e,s,{get:t[s],enumerable:!0})},F=(e,t,s,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of M(t))!C.call(e,i)&&i!==s&&p(e,i,{get:()=>t[i],enumerable:!(r=E(t,i))||r.enumerable});return e};var D=e=>F(p({},"__esModule",{value:!0}),e);var J={};N(J,{default:()=>$});module.exports=D(J);var o=require("@raycast/api"),w=require("child_process");var u=require("fs");var h=e=>{let t=Math.floor(e/3600),s=String(Math.floor(e%3600/60)).padStart(2,"0"),r=String(Math.floor(e%60)).padStart(2,"0");return`${t===0?"":t+":"}${s}:${r}`};var n=require("@raycast/api"),d=require("fs");var g=e=>{let t=(0,n.getPreferenceValues)();if(e.launchedFromMenuBar||t.closeWindowOnTimerStart){let s=e.isErr?"\u26A0\uFE0F":"\u{1F389}";return(0,n.showHUD)(`${s} ${e.msg}`),(0,n.popToRoot)()}else(0,n.showToast)({style:e.isErr?n.Toast.Style.Failure:n.Toast.Style.Success,title:e.msg})},T=async()=>{let e=n.environment.supportPath+"/ringContinuouslyWarningShown";if(!(0,n.getPreferenceValues)().ringContinuously||(0,d.existsSync)(e))return!0;let s=await(0,n.confirmAlert)({title:"Ring Continuously is enabled!",icon:n.Icon.Bell,message:'When the timer rings, you will need to use the "Stop Running Timer" command or stop the timer in the "Manage Timers" command to dismiss the sound. You can configure this in your Raycast settings.'});return s&&(0,d.writeFileSync)(e,""),s};var v=o.environment.supportPath+"/customTimers.json",V=o.environment.supportPath+"/defaultPresetVisibles.json";var y=(e=!1)=>{let t=(0,o.getPreferenceValues)();return parseFloat(t.volumeSetting)>5?(g({msg:"Timer alert volume should not be louder than 5 (it can get quite loud!)",launchedFromMenuBar:e,isErr:!0}),!1):!0};async function P({timeInSeconds:e,timerName:t="Untitled",launchedFromMenuBar:s=!1,selectedSound:r="default"}){if(!await T())return;let c=(o.environment.supportPath+"/"+new Date().toISOString()+"---"+e+".timer").replace(/:/g,"__"),a=(0,o.getPreferenceValues)();if(a.ringContinuously){let m=`${c}`.replace(".timer",".dismiss");(0,u.writeFileSync)(m,".dismiss file for Timers")}let l=b(c,t,e,r),f=(0,w.exec)(l,(m,S)=>{if(m){console.log(`error: ${m.message}`);return}if(S){console.log(`stderr: ${S}`);return}}),O={name:t,pid:f.pid,lastPaused:"---",pauseElapsed:0,selectedSound:r==="default"?a.selectedSound:r};(0,u.writeFileSync)(c,JSON.stringify(O)),g({msg:`Timer "${t}" started for ${h(e)}!`,launchedFromMenuBar:s,isErr:!1})}function b(e,t,s,r){let i=(0,o.getPreferenceValues)(),c=`${o.environment.assetsPath+"/"+(r==="default"?i.selectedSound:r)}`,a=[`sleep ${s}`];a.push(`if [ -f "${e}" ]; then osascript -e 'display notification "Timer \\"${t}\\" complete" with title "Ding!"'`);let l=i.selectedSound==="speak_timer_name"?`say ${t}`:`afplay "${c}" --volume ${i.volumeSetting.replace(",",".")}`;if(a.push(l),i.ringContinuously){let f=`${e}`.replace(".timer",".dismiss");a.push(`while [ -f "${f}" ]; do ${l}; done`)}return a.push(`rm "${e}"; else echo "Timer deleted"; fi`),a.join(" ; ")}var $=async()=>{y()&&await P({timeInSeconds:60*45,timerName:"45 Minute Timer"})};
